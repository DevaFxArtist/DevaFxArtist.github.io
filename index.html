<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Deva | FX Artist</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;}

body{
font-family:-apple-system,BlinkMacSystemFont,sans-serif;
background:radial-gradient(circle at top,#111 0%,#000 60%);
color:white;
min-height:100vh;
user-select:none;
}

.hero{text-align:center;padding:80px 20px 40px;}
.hero h1{font-size:48px;}
.hero p{color:#aaa;margin-top:10px;}

.grid{
max-width:900px;
margin:40px auto;
display:grid;
grid-template-columns:repeat(auto-fit,minmax(250px,1fr));
gap:20px;
padding:20px;
}

.card{
position:relative;
background:rgba(255,255,255,0.05);
backdrop-filter:blur(10px);
border-radius:16px;
padding:40px 20px;
text-align:center;
border:1px solid rgba(255,255,255,0.08);
transition:all .2s ease;
cursor:pointer;
}

.card.large{grid-column:span 2;}

.drag-placeholder{
background:rgba(255,255,255,0.03);
border:2px dashed rgba(255,255,255,0.15);
color:transparent;
}

.floating{
position:fixed;
pointer-events:none;
z-index:9999;
opacity:0.95;
transform:scale(1.05);
}

.edit-controls{
position:absolute;
top:8px;
right:8px;
display:none;
gap:6px;
}

.edit-mode .edit-controls{display:flex;}

.icon-btn{
background:rgba(0,0,0,0.6);
border:none;
color:white;
border-radius:6px;
padding:4px 6px;
cursor:pointer;
font-size:13px;
}

.add-card{
display:none;
align-items:center;
justify-content:center;
font-size:28px;
background:rgba(255,255,255,0.05);
border:2px dashed rgba(255,255,255,0.2);
}

.edit-mode .add-card{display:flex;}

.toggle-btn{
position:fixed;
bottom:20px;
right:20px;
background:#222;
border:none;
color:white;
padding:12px 16px;
border-radius:10px;
cursor:pointer;
transition:all .3s ease;
}

.toggle-btn.save-mode{background:green;}

footer{text-align:center;padding:40px;color:#555;}

.modal{
position:fixed;
inset:0;
background:rgba(0,0,0,0.6);
display:none;
align-items:center;
justify-content:center;
}

.modal-content{
background:#1c1c1c;
padding:30px;
border-radius:12px;
width:300px;
}

.modal input{
width:100%;
padding:8px;
margin-top:10px;
border-radius:6px;
border:none;
}
</style>
</head>

<body>

<div class="hero"></div>

<div class="grid" id="grid"></div>

<footer>¬© 2026 Deva</footer>

<button id="toggleBtn" class="toggle-btn" onclick="handleToggle()">‚úè Edit Mode</button>

<div class="modal" id="linkModal">
<div class="modal-content">
<h3>Edit Link</h3>
<input type="text" id="linkInput">
<button onclick="saveLink()">Save</button>
</div>
</div>
  
<script>

let pageData = {
  hero: {
    name: "Deva Bhuvaneswaran",
    about: "FX Artist | Procedural FX",
    profileImage: ""
  },
  links: []
};

let editMode = false;
let draggingEl = null;
let floatingEl = null;
let editingId = null;

function generateId(){
  return Math.random().toString(36).substr(2,9);
}

async function loadGrid(){
  const res = await fetch("data.json");
  const raw = await res.json();

  pageData.links = raw.map(card => ({
    ...card,
    id: generateId()
  }));

  renderAll();
}

function renderAll(){
  renderHero();
  renderLinks();
}

function renderHero(){
  const hero = document.querySelector(".hero");

  hero.innerHTML = `
    <h1 ondblclick="enableHeroEdit(this,'name')">
      ${pageData.hero.name}
    </h1>
    <p ondblclick="enableHeroEdit(this,'about')">
      ${pageData.hero.about}
    </p>
  `;
}

function enableHeroEdit(el, field){
  if(!editMode) return;

  el.contentEditable = true;
  el.focus();

  el.onblur = () => {
    pageData.hero[field] = el.innerText;
    el.contentEditable = false;
  };
}

function renderLinks(){
  const grid = document.getElementById("grid");
  grid.innerHTML = "";

  pageData.links.forEach(card => {

    const div = document.createElement("div");
    div.className = "card";
    div.dataset.id = card.id;

    if(card.size === "large")
      div.classList.add("large");

    div.innerHTML = `
      <span ondblclick="enableEdit(this,'${card.id}')">
        ${card.title}
      </span>

      <div class="edit-controls">
        <button class="icon-btn"
          onclick="event.stopPropagation(); openLinkModal('${card.id}')">
          üîó
        </button>

        <button class="icon-btn"
          onclick="event.stopPropagation(); toggleSize('${card.id}')">
          ‚¨õ
        </button>

        <button class="icon-btn"
          onclick="event.stopPropagation(); deleteCard('${card.id}')">
          üóë
        </button>
      </div>
    `;

    if(!editMode){
      div.onclick = () => {
        if(card.link && card.link !== "#"){
          window.open(card.link, "_blank", "noopener");
        }
      };
    }

    if(editMode){
      div.onmousedown = (e) => startDrag(e, div);
    }

    grid.appendChild(div);
  });

  if(editMode){
    const add = document.createElement("div");
    add.className = "card add-card";
    add.innerHTML = "+";
    add.onclick = addCard;
    grid.appendChild(add);
  }
}

function enableEdit(el, id){
  if(!editMode) return;

  el.contentEditable = true;
  el.focus();

  el.onblur = () => {
    const card = pageData.links.find(c => c.id === id);
    card.title = el.innerText;
    el.contentEditable = false;
  };
}

function deleteCard(id){
  pageData.links =
    pageData.links.filter(c => c.id !== id);
  renderLinks();
}

function addCard(){
  pageData.links.push({
    id: generateId(),
    title: "New Card",
    link: "#",
    size: "normal"
  });
  renderLinks();
}

function toggleSize(id){
  const card =
    pageData.links.find(c => c.id === id);

  card.size =
    card.size === "large" ? "normal" : "large";

  renderLinks();
}

function openLinkModal(id){
  editingId = id;

  document.getElementById("linkInput").value =
    pageData.links.find(c => c.id === id).link;

  document.getElementById("linkModal").style.display = "flex";
}

function saveLink(){
  pageData.links.find(c => c.id === editingId).link =
    document.getElementById("linkInput").value;

  document.getElementById("linkModal").style.display = "none";
}

function startDrag(e, element){
  draggingEl = element;

  floatingEl = element.cloneNode(true);
  floatingEl.classList.add("floating");
  floatingEl.style.width =
    element.offsetWidth + "px";
  floatingEl.style.height =
    element.offsetHeight + "px";

  floatingEl.querySelector(".edit-controls")?.remove();

  document.body.appendChild(floatingEl);

  element.classList.add("drag-placeholder");

  moveFloating(e);

  document.addEventListener("mousemove", moveDrag);
  document.addEventListener("mouseup", endDrag);
}

function moveFloating(e){
  floatingEl.style.left =
    e.clientX - (floatingEl.offsetWidth / 2) + "px";

  floatingEl.style.top =
    e.clientY - (floatingEl.offsetHeight / 2) + "px";
}

function moveDrag(e){
  moveFloating(e);

  const elements = [
    ...document.querySelectorAll(
      ".grid .card:not(.drag-placeholder)"
    )
  ];

  for(const el of elements){

    const rect = el.getBoundingClientRect();

    if(
      e.clientX > rect.left &&
      e.clientX < rect.right &&
      e.clientY > rect.top &&
      e.clientY < rect.bottom
    ){
      if(el !== draggingEl){
        el.parentNode.insertBefore(draggingEl, el);
      }
      break;
    }
  }
}

function endDrag(){
  draggingEl.classList.remove("drag-placeholder");

  floatingEl.remove();

  updateArrayFromDOM();

  document.removeEventListener("mousemove", moveDrag);
  document.removeEventListener("mouseup", endDrag);
}

function updateArrayFromDOM(){
  const domCards = [
    ...document.querySelectorAll(
      ".grid .card:not(.add-card)"
    )
  ];

  pageData.links = domCards.map(el =>
    pageData.links.find(
      c => c.id === el.dataset.id
    )
  );
}

function handleToggle(){
  editMode = !editMode;

  const btn =
    document.getElementById("toggleBtn");

  if(editMode){
    document.body.classList.add("edit-mode");
    btn.innerText = "üíæ Save Changes";
    btn.classList.add("save-mode");
  } else {
    document.body.classList.remove("edit-mode");
    btn.innerText = "‚úè Edit Mode";
    btn.classList.remove("save-mode");
  }

  renderAll();
}

loadGrid();

</script>
